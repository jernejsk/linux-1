// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
// Copyright (C) 2024 Jernej Skrabec <jernej.skrabec@gmail.com>

/ {
	ac300_pwm_clk: ac300_clk {
		compatible = "pwm-clock";
		#clock-cells = <0>;
		clock-frequency = <24000000>;
		pinctrl-names = "default";
		pinctrl-0 = <&pwm5_pin>;
		pwms = <&pwm 5 42 0>;
	};
};

&emac1 {
	phy-handle = <&rmii_phy>;
	allwinner,rx-delay-ps = <3100>;
	allwinner,tx-delay-ps = <700>;
	status = "okay";
};

&i2c3 {
	pinctrl-names = "default";
	pinctrl-0 = <&i2c3_pa_pins>;
	status = "okay";

	ac300: mfd@10 {
		compatible = "x-powers,ac200";
		reg = <0x10>;
		clocks = <&ac300_pwm_clk>;

		ac300_ephy_ctl: syscon {
			compatible = "x-powers,ac200-ephy-ctl";
			nvmem-cells = <&ephy_calib>;
			nvmem-cell-names = "calibration";
			#clock-cells = <0>;
			#reset-cells = <0>;
			phy-mode = "rmii";
			phy-address = <1>;
		};
	};
};

&i2c3_pa_pins {
	bias-pull-up;
};

&mdio1 {
	rmii_phy: ethernet-phy@1 {
		compatible = "ethernet-phy-id0044.1400",
			     "ethernet-phy-ieee802.3-c22";
		reg = <1>;
		resets = <&ac300_ephy_ctl>;
		reset-names = "phy";
		clocks = <&ac300_ephy_ctl>;
	};
};

&pwm {
	status = "okay";
};
